import{c as Pt,V as Rt,f as Nt,g as At}from"./gallery.dcd0cbfb.js";import{o as p,c as m,a as g,e as S,aM as Ge,h as He,g as L,F as ee,j as ae,q as Z,bA as Qe,x as Ze,t as j,a6 as Y,aB as Ce,L as G,I as w,M as le,D as Pe,aT as ut,_ as Ne,r as ot,b as Je,w as ke,u as qt,d as x,n as We,i as Re,v as Dt}from"./lodash.5e8f7418.js";import{s as Mt,t as Xe,F as Kt}from"./gallery-secondsToTimeString.bf50597f.js";import{_ as Ft}from"./gallery-findSubPageSource.13590a77.js";import{_ as zt}from"./gallery-page-title.d18613c6.js";const Vt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},jt=g("path",{fill:"currentColor",d:"M3 5v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2z"},null,-1),Gt=[jt];function Ht(e,s){return p(),m("svg",Vt,Gt)}var Wt={name:"ic-round-square",render:Ht};const Ut={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},Qt=g("path",{fill:"currentColor",d:"M256 56c110.532 0 200 89.451 200 200c0 110.532-89.451 200-200 200c-110.532 0-200-89.451-200-200c0-110.532 89.451-200 200-200m0-48C119.033 8 8 119.033 8 256s111.033 248 248 248s248-111.033 248-248S392.967 8 256 8zm0 168c-44.183 0-80 35.817-80 80s35.817 80 80 80s80-35.817 80-80s-35.817-80-80-80z"},null,-1),Zt=[Qt];function Jt(e,s){return p(),m("svg",Ut,Zt)}var Xt={name:"fa-regular-dot-circle",render:Jt};const Yt={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},xt=g("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248s248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200s-89.5 200-200 200z"},null,-1),es=[xt];function ts(e,s){return p(),m("svg",Yt,es)}var ss={name:"fa-regular-circle",render:ts};const as={viewBox:"0 0 320 512",width:"1.2em",height:"1.2em"},ls=g("path",{fill:"currentColor",d:"M182.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9S19 224.1 32 224.1h256c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),is=[ls];function ns(e,s){return p(),m("svg",as,is)}var rs={name:"fa6-solid-sort-up",render:ns};const os={viewBox:"0 0 320 512",width:"1.2em",height:"1.2em"},us=g("path",{fill:"currentColor",d:"M182.6 470.6c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-9.2-9.2-11.9-22.9-6.9-34.9S19 287.9 32 287.9h256c12.9 0 24.6 7.8 29.6 19.8s2.2 25.7-6.9 34.9l-128 128z"},null,-1),cs=[us];function ds(e,s){return p(),m("svg",os,cs)}var fs={name:"fa6-solid-sort-down",render:ds};function re(e){return[null,void 0].indexOf(e)!==-1}function vs(e,s,t){const{object:n,valueProp:i,mode:r}=Y(e),l=Ce().proxy,c=t.iv,y=(h,B=!0)=>{c.value=d(h);const T=v(h);s.emit("change",T,l),B&&(s.emit("input",T),s.emit("update:modelValue",T))},v=h=>n.value||re(h)?h:Array.isArray(h)?h.map(B=>B[i.value]):h[i.value],d=h=>re(h)?r.value==="single"?{}:[]:h;return{update:y}}function hs(e,s){const{value:t,modelValue:n,mode:i,valueProp:r}=Y(e),l=G(i.value!=="single"?[]:{}),c=n&&n.value!==void 0?n:t,y=w(()=>i.value==="single"?l.value[r.value]:l.value.map(d=>d[r.value])),v=w(()=>i.value!=="single"?l.value.map(d=>d[r.value]).join(","):l.value[r.value]);return{iv:l,internalValue:l,ev:c,externalValue:c,textValue:v,plainValue:y}}function ps(e,s,t){const{regex:n}=Y(e),i=Ce().proxy,r=t.isOpen,l=t.open,c=G(null),y=G(null),v=()=>{c.value=""},d=T=>{c.value=T.target.value},h=T=>{if(n&&n.value){let I=n.value;typeof I=="string"&&(I=new RegExp(I)),T.key.match(I)||T.preventDefault()}},B=T=>{if(n&&n.value){let P=(T.clipboardData||window.clipboardData).getData("Text"),q=n.value;typeof q=="string"&&(q=new RegExp(q)),P.split("").every(C=>!!C.match(q))||T.preventDefault()}s.emit("paste",T,i)};return le(c,T=>{!r.value&&T&&l(),s.emit("search-change",T,i)}),{search:c,input:y,clearSearch:v,handleSearchInput:d,handleKeypress:h,handlePaste:B}}function ms(e,s,t){const{groupSelect:n,mode:i,groups:r,disabledProp:l}=Y(e),c=G(null),y=d=>{d===void 0||d!==null&&d[l.value]||r.value&&d&&d.group&&(i.value==="single"||!n.value)||(c.value=d)};return{pointer:c,setPointer:y,clearPointer:()=>{y(null)}}}function Ue(e,s=!0){return s?String(e).toLowerCase().trim():String(e).toLowerCase().normalize("NFD").trim().replace(new RegExp(/æ/g),"ae").replace(new RegExp(/œ/g),"oe").replace(new RegExp(/ø/g),"o").replace(/\p{Diacritic}/gu,"")}function gs(e){return Object.prototype.toString.call(e)==="[object Object]"}function ys(e,s){const t=s.slice().sort();return e.length===s.length&&e.slice().sort().every(function(n,i){return n===t[i]})}function bs(e,s,t){const{options:n,mode:i,trackBy:r,limit:l,hideSelected:c,createTag:y,createOption:v,label:d,appendNewTag:h,appendNewOption:B,multipleLabel:T,object:I,loading:P,delay:q,resolveOnLoad:C,minChars:f,filterResults:A,clearOnSearch:F,clearOnSelect:H,valueProp:O,allowAbsent:V,groupLabel:W,canDeselect:K,max:J,strict:te,closeOnSelect:b,closeOnDeselect:E,groups:se,reverse:oe,infinite:Oe,groupOptions:U,groupHideEmpty:Te,groupSelect:R,onCreate:D,disabledProp:M,searchStart:fe,searchFilter:Se}=Y(e),Q=Ce().proxy,N=t.iv,o=t.ev,k=t.search,X=t.clearSearch,ue=t.update,ct=t.pointer,pe=t.clearPointer,dt=t.focus,ft=t.deactivate,me=t.close,vt=t.localize,_e=G([]),ve=G([]),ie=G(!1),Ae=G(null),qe=G(Oe.value&&l.value===-1?10:l.value),xe=w(()=>y.value||v.value||!1),ht=w(()=>h.value!==void 0?h.value:B.value!==void 0?B.value:!0),he=w(()=>{if(se.value){let a=$e.value||[],u=[];return a.forEach($=>{Ve($[U.value]).forEach(z=>{u.push(Object.assign({},z,$[M.value]?{[M.value]:!0}:{}))})}),u}else{let a=Ve(ve.value||[]);return _e.value.length&&(a=a.concat(_e.value)),a}}),et=w(()=>{let a=he.value;return oe.value&&(a=a.reverse()),ge.value.length&&(a=ge.value.concat(a)),ze(a)}),we=w(()=>{let a=et.value;return qe.value>0&&(a=a.slice(0,qe.value)),a}),$e=w(()=>{if(!se.value)return[];let a=[],u=ve.value||[];return _e.value.length&&a.push({[W.value]:" ",[U.value]:[..._e.value],__CREATE__:!0}),a.concat(u)}),pt=w(()=>{let a=[...$e.value].map(u=>({...u}));return ge.value.length&&(a[0]&&a[0].__CREATE__?a[0][U.value]=[...ge.value,...a[0][U.value]]:a=[{[W.value]:" ",[U.value]:[...ge.value],__CREATE__:!0}].concat(a)),a}),tt=w(()=>{if(!se.value)return[];let a=pt.value;return It((a||[]).map((u,$)=>{const z=Ve(u[U.value]);return{...u,index:$,group:!0,[U.value]:ze(z,!1).map(Le=>Object.assign({},Le,u[M.value]?{[M.value]:!0}:{})),__VISIBLE__:ze(z).map(Le=>Object.assign({},Le,u[M.value]?{[M.value]:!0}:{}))}}))}),De=w(()=>{switch(i.value){case"single":return!re(N.value[O.value]);case"multiple":case"tags":return!re(N.value)&&N.value.length>0}}),mt=w(()=>T!==void 0&&T.value!==void 0?T.value(N.value,Q):N.value&&N.value.length>1?`${N.value.length} options selected`:"1 option selected"),gt=w(()=>!he.value.length&&!ie.value&&!ge.value.length),yt=w(()=>he.value.length>0&&we.value.length==0&&(k.value&&se.value||!se.value)),ge=w(()=>xe.value===!1||!k.value?[]:Tt(k.value)!==-1?[]:[{[O.value]:k.value,[ne.value]:k.value,[d.value]:k.value,__CREATE__:!0}]),ne=w(()=>r.value||d.value),bt=w(()=>{switch(i.value){case"single":return null;case"multiple":case"tags":return[]}}),kt=w(()=>P.value||ie.value),ye=a=>{switch(typeof a!="object"&&(a=de(a)),i.value){case"single":ue(a);break;case"multiple":case"tags":ue(N.value.concat(a));break}s.emit("select",st(a),a,Q)},be=a=>{switch(typeof a!="object"&&(a=de(a)),i.value){case"single":lt();break;case"tags":case"multiple":ue(Array.isArray(a)?N.value.filter(u=>a.map($=>$[O.value]).indexOf(u[O.value])===-1):N.value.filter(u=>u[O.value]!=a[O.value]));break}s.emit("deselect",st(a),a,Q)},st=a=>I.value?a:a[O.value],at=a=>{be(a)},Ot=(a,u)=>{if(u.button!==0){u.preventDefault();return}at(a)},lt=()=>{s.emit("clear",Q),ue(bt.value)},ce=a=>{if(a.group!==void 0)return i.value==="single"?!1:Ct(a[U.value])&&a[U.value].length;switch(i.value){case"single":return!re(N.value)&&N.value[O.value]==a[O.value];case"tags":case"multiple":return!re(N.value)&&N.value.map(u=>u[O.value]).indexOf(a[O.value])!==-1}},Me=a=>a[M.value]===!0,Ke=()=>J===void 0||J.value===-1||!De.value&&J.value>0?!1:N.value.length>=J.value,St=a=>{if(!Me(a)){if(D&&D.value&&!ce(a)&&a.__CREATE__&&(a={...a},delete a.__CREATE__,a=D.value(a,Q),a instanceof Promise)){ie.value=!0,a.then(u=>{ie.value=!1,it(u)});return}it(a)}},it=a=>{switch(a.__CREATE__&&(a={...a},delete a.__CREATE__),i.value){case"single":if(a&&ce(a)){K.value&&be(a),E.value&&(pe(),me());return}a&&Fe(a),H.value&&X(),b.value&&(pe(),me()),a&&ye(a);break;case"multiple":if(a&&ce(a)){be(a),E.value&&(pe(),me());return}if(Ke()){s.emit("max",Q);return}a&&(Fe(a),ye(a)),H.value&&X(),c.value&&pe(),b.value&&me();break;case"tags":if(a&&ce(a)){be(a),E.value&&(pe(),me());return}if(Ke()){s.emit("max",Q);return}a&&Fe(a),H.value&&X(),a&&ye(a),c.value&&pe(),b.value&&me();break}b.value||dt()},_t=a=>{if(!(Me(a)||i.value==="single"||!R.value)){switch(i.value){case"multiple":case"tags":Lt(a[U.value])?be(a[U.value]):ye(a[U.value].filter(u=>N.value.map($=>$[O.value]).indexOf(u[O.value])===-1).filter(u=>!u[M.value]).filter((u,$)=>N.value.length+1+$<=J.value||J.value===-1));break}b.value&&ft()}},Fe=a=>{de(a[O.value])===void 0&&xe.value&&(s.emit("tag",a[O.value],Q),s.emit("option",a[O.value],Q),s.emit("create",a[O.value],Q),ht.value&&Bt(a),X())},wt=()=>{i.value!=="single"&&ye(we.value.filter(a=>!a.disabled&&!ce(a)))},Lt=a=>a.find(u=>!ce(u)&&!u[M.value])===void 0,Ct=a=>a.find(u=>!ce(u))===void 0,de=a=>he.value[he.value.map(u=>String(u[O.value])).indexOf(String(a))],Tt=(a,u=!0)=>he.value.map($=>parseInt($[ne.value])==$[ne.value]?parseInt($[ne.value]):$[ne.value]).indexOf(parseInt(a)==a?parseInt(a):a),$t=a=>["tags","multiple"].indexOf(i.value)!==-1&&c.value&&ce(a),Bt=a=>{_e.value.push(a)},It=a=>Te.value?a.filter(u=>k.value?u.__VISIBLE__.length:u[U.value].length):a.filter(u=>k.value?u.__VISIBLE__.length:!0),ze=(a,u=!0)=>{let $=a;if(k.value&&A.value){let z=Se.value;z||(z=(Le,tl)=>{let rt=Ue(vt(Le[ne.value]),te.value);return fe.value?rt.startsWith(Ue(k.value,te.value)):rt.indexOf(Ue(k.value,te.value))!==-1}),$=$.filter(z)}return c.value&&u&&($=$.filter(z=>!$t(z))),$},Ve=a=>{let u=a;return gs(u)&&(u=Object.keys(u).map($=>{let z=u[$];return{[O.value]:$,[ne.value]:z,[d.value]:z}})),u=u.map($=>typeof $=="object"?$:{[O.value]:$,[ne.value]:$,[d.value]:$}),u},Be=()=>{re(o.value)||(N.value=Ee(o.value))},Ie=a=>(ie.value=!0,new Promise((u,$)=>{n.value(k.value,Q).then(z=>{ve.value=z||[],typeof a=="function"&&a(z),ie.value=!1}).catch(z=>{console.error(z),ve.value=[],ie.value=!1}).finally(()=>{u()})})),je=()=>{if(!!De.value)if(i.value==="single"){let a=de(N.value[O.value]);if(a!==void 0){let u=a[d.value];N.value[d.value]=u,I.value&&(o.value[d.value]=u)}}else N.value.forEach((a,u)=>{let $=de(N.value[u][O.value]);if($!==void 0){let z=$[d.value];N.value[u][d.value]=z,I.value&&(o.value[u][d.value]=z)}})},Et=a=>{Ie(a)},Ee=a=>re(a)?i.value==="single"?{}:[]:I.value?a:i.value==="single"?de(a)||(V.value?{[d.value]:a,[O.value]:a,[ne.value]:a}:{}):a.filter(u=>!!de(u)||V.value).map(u=>de(u)||{[d.value]:u,[O.value]:u,[ne.value]:u}),nt=()=>{Ae.value=le(k,a=>{a.length<f.value||!a&&f.value!==0||(ie.value=!0,F.value&&(ve.value=[]),setTimeout(()=>{a==k.value&&n.value(k.value,Q).then(u=>{(a==k.value||!k.value)&&(ve.value=u,ct.value=we.value.filter($=>$[M.value]!==!0)[0]||null,ie.value=!1)}).catch(u=>{console.error(u)})},q.value))},{flush:"sync"})};if(i.value!=="single"&&!re(o.value)&&!Array.isArray(o.value))throw new Error(`v-model must be an array when using "${i.value}" mode`);return n&&typeof n.value=="function"?C.value?Ie(Be):I.value==!0&&Be():(ve.value=n.value,Be()),q.value>-1&&nt(),le(q,(a,u)=>{Ae.value&&Ae.value(),a>=0&&nt()}),le(o,a=>{if(re(a)){ue(Ee(a),!1);return}switch(i.value){case"single":(I.value?a[O.value]!=N.value[O.value]:a!=N.value[O.value])&&ue(Ee(a),!1);break;case"multiple":case"tags":ys(I.value?a.map(u=>u[O.value]):a,N.value.map(u=>u[O.value]))||ue(Ee(a),!1);break}},{deep:!0}),le(n,(a,u)=>{typeof e.options=="function"?C.value&&(!u||a&&a.toString()!==u.toString())&&Ie():(ve.value=e.options,Object.keys(N.value).length||Be(),je())}),le(d,je),{pfo:et,fo:we,filteredOptions:we,hasSelected:De,multipleLabelText:mt,eo:he,extendedOptions:he,eg:$e,extendedGroups:$e,fg:tt,filteredGroups:tt,noOptions:gt,noResults:yt,resolving:ie,busy:kt,offset:qe,select:ye,deselect:be,remove:at,selectAll:wt,clear:lt,isSelected:ce,isDisabled:Me,isMax:Ke,getOption:de,handleOptionClick:St,handleGroupClick:_t,handleTagRemove:Ot,refreshOptions:Et,resolveOptions:Ie,refreshLabels:je}}function ks(e,s,t){const{valueProp:n,showOptions:i,searchable:r,groupLabel:l,groups:c,mode:y,groupSelect:v,disabledProp:d,groupOptions:h}=Y(e),B=t.fo,T=t.fg,I=t.handleOptionClick,P=t.handleGroupClick,q=t.search,C=t.pointer,f=t.setPointer,A=t.clearPointer,F=t.multiselect,H=t.isOpen,O=w(()=>B.value.filter(o=>!o[d.value])),V=w(()=>T.value.filter(o=>!o[d.value])),W=w(()=>y.value!=="single"&&v.value),K=w(()=>C.value&&C.value.group),J=w(()=>Q(C.value)),te=w(()=>{const o=K.value?C.value:Q(C.value),k=V.value.map(ue=>ue[l.value]).indexOf(o[l.value]);let X=V.value[k-1];return X===void 0&&(X=E.value),X}),b=w(()=>{let o=V.value.map(k=>k.label).indexOf(K.value?C.value[l.value]:Q(C.value)[l.value])+1;return V.value.length<=o&&(o=0),V.value[o]}),E=w(()=>[...V.value].slice(-1)[0]),se=w(()=>C.value.__VISIBLE__.filter(o=>!o[d.value])[0]),oe=w(()=>{const o=J.value.__VISIBLE__.filter(k=>!k[d.value]);return o[o.map(k=>k[n.value]).indexOf(C.value[n.value])-1]}),Oe=w(()=>{const o=Q(C.value).__VISIBLE__.filter(k=>!k[d.value]);return o[o.map(k=>k[n.value]).indexOf(C.value[n.value])+1]}),U=w(()=>[...te.value.__VISIBLE__.filter(o=>!o[d.value])].slice(-1)[0]),Te=w(()=>[...E.value.__VISIBLE__.filter(o=>!o[d.value])].slice(-1)[0]),R=o=>!!C.value&&(!o.group&&C.value[n.value]===o[n.value]||o.group!==void 0&&C.value[l.value]===o[l.value])?!0:void 0,D=()=>{f(O.value[0]||null)},M=()=>{!C.value||C.value[d.value]===!0||(K.value?P(C.value):I(C.value))},fe=()=>{if(C.value===null)f((c.value&&W.value?V.value[0].__CREATE__?O.value[0]:V.value[0]:O.value[0])||null);else if(c.value&&W.value){let o=K.value?se.value:Oe.value;o===void 0&&(o=b.value,o.__CREATE__&&(o=o[h.value][0])),f(o||null)}else{let o=O.value.map(k=>k[n.value]).indexOf(C.value[n.value])+1;O.value.length<=o&&(o=0),f(O.value[o]||null)}Pe(()=>{N()})},Se=()=>{if(C.value===null){let o=O.value[O.value.length-1];c.value&&W.value&&(o=Te.value,o===void 0&&(o=E.value)),f(o||null)}else if(c.value&&W.value){let o=K.value?U.value:oe.value;o===void 0&&(o=K.value?te.value:J.value,o.__CREATE__&&(o=U.value,o===void 0&&(o=te.value))),f(o||null)}else{let o=O.value.map(k=>k[n.value]).indexOf(C.value[n.value])-1;o<0&&(o=O.value.length-1),f(O.value[o]||null)}Pe(()=>{N()})},Q=o=>V.value.find(k=>k.__VISIBLE__.map(X=>X[n.value]).indexOf(o[n.value])!==-1),N=()=>{let o=F.value.querySelector("[data-pointed]");if(!o)return;let k=o.parentElement.parentElement;c.value&&(k=K.value?o.parentElement.parentElement.parentElement:o.parentElement.parentElement.parentElement.parentElement),o.offsetTop+o.offsetHeight>k.clientHeight+k.scrollTop&&(k.scrollTop=o.offsetTop+o.offsetHeight-k.clientHeight),o.offsetTop<k.scrollTop&&(k.scrollTop=o.offsetTop)};return le(q,o=>{r.value&&(o.length&&i.value?D():A())}),le(H,o=>{if(o){let k=F.value.querySelectorAll("[data-selected]")[0];if(!k)return;let X=k.parentElement.parentElement;Pe(()=>{X.scrollTop>0||(X.scrollTop=k.offsetTop)})}}),{pointer:C,canPointGroups:W,isPointed:R,setPointerFirst:D,selectPointer:M,forwardPointer:fe,backwardPointer:Se}}function Os(e,s,t){const{disabled:n}=Y(e),i=Ce().proxy,r=G(!1);return{isOpen:r,open:()=>{r.value||n.value||(r.value=!0,s.emit("open",i))},close:()=>{!r.value||(r.value=!1,s.emit("close",i))}}}function Ss(e,s,t){const{searchable:n,disabled:i,clearOnBlur:r}=Y(e),l=t.input,c=t.open,y=t.close,v=t.clearSearch,d=t.isOpen,h=G(null),B=G(null),T=G(null),I=G(!1),P=G(!1),q=w(()=>n.value||i.value?-1:0),C=()=>{n.value&&l.value.blur(),B.value.blur()},f=()=>{n.value&&!i.value&&l.value.focus()},A=(K=!0)=>{i.value||(I.value=!0,K&&c())},F=()=>{I.value=!1,setTimeout(()=>{I.value||(y(),r.value&&v())},1)};return{multiselect:h,wrapper:B,tags:T,tabindex:q,isActive:I,mouseClicked:P,blur:C,focus:f,activate:A,deactivate:F,handleFocusIn:K=>{K.target.closest("[data-tags]")&&K.target.nodeName!=="INPUT"||K.target.closest("[data-clear]")||A(P.value)},handleFocusOut:()=>{F()},handleCaretClick:()=>{F(),C()},handleMousedown:K=>{P.value=!0,d.value&&(K.target.isEqualNode(B.value)||K.target.isEqualNode(T.value))?setTimeout(()=>{F()},0):document.activeElement.isEqualNode(B.value)&&!d.value&&A(),setTimeout(()=>{P.value=!1},0)}}}function _s(e,s,t){const{mode:n,addTagOn:i,openDirection:r,searchable:l,showOptions:c,valueProp:y,groups:v,addOptionOn:d,createTag:h,createOption:B,reverse:T}=Y(e),I=Ce().proxy,P=t.iv,q=t.update,C=t.search,f=t.setPointer,A=t.selectPointer,F=t.backwardPointer,H=t.forwardPointer,O=t.multiselect,V=t.wrapper,W=t.tags,K=t.isOpen,J=t.open,te=t.blur,b=t.fo,E=w(()=>h.value||B.value||!1),se=w(()=>i.value!==void 0?i.value:d.value!==void 0?d.value:["enter"]),oe=()=>{n.value==="tags"&&!c.value&&E.value&&l.value&&!v.value&&f(b.value[b.value.map(R=>R[y.value]).indexOf(C.value)])},Oe=R=>{let D=R.length-1;for(;D>=0&&(R[D].remove===!1||R[D].disabled);)D--;return D<0||R.splice(D,1),R};return{handleKeydown:R=>{s.emit("keydown",R,I);let D,M;switch(["ArrowLeft","ArrowRight","Enter"].indexOf(R.key)!==-1&&n.value==="tags"&&(D=[...O.value.querySelectorAll("[data-tags] > *")].filter(fe=>fe!==W.value),M=D.findIndex(fe=>fe===document.activeElement)),R.key){case"Backspace":if(n.value==="single"||l.value&&[null,""].indexOf(C.value)===-1||P.value.length===0)return;q(Oe([...P.value]));break;case"Enter":if(R.preventDefault(),R.keyCode===229)return;if(M!==-1&&M!==void 0){q([...P.value].filter((fe,Se)=>Se!==M)),M===D.length-1&&(D.length-1?D[D.length-2].focus():l.value?W.value.querySelector("input").focus():V.value.focus());return}if(se.value.indexOf("enter")===-1&&E.value)return;oe(),A();break;case" ":if(!E.value&&!l.value){R.preventDefault(),oe(),A();return}if(!E.value)return!1;if(se.value.indexOf("space")===-1&&E.value)return;R.preventDefault(),oe(),A();break;case"Tab":case";":case",":if(se.value.indexOf(R.key.toLowerCase())===-1||!E.value)return;oe(),A(),R.preventDefault();break;case"Escape":te();break;case"ArrowUp":if(R.preventDefault(),!c.value)return;K.value||J(),F();break;case"ArrowDown":if(R.preventDefault(),!c.value)return;K.value||J(),H();break;case"ArrowLeft":if(l.value&&W.value&&W.value.querySelector("input").selectionStart||R.shiftKey||n.value!=="tags"||!P.value||!P.value.length)return;R.preventDefault(),M===-1?D[D.length-1].focus():M>0&&D[M-1].focus();break;case"ArrowRight":if(M===-1||R.shiftKey||n.value!=="tags"||!P.value||!P.value.length)return;R.preventDefault(),D.length>M+1?D[M+1].focus():l.value?W.value.querySelector("input").focus():l.value||V.value.focus();break}},handleKeyup:R=>{s.emit("keyup",R,I)},preparePointer:oe}}function ws(e,s,t){const{classes:n,disabled:i,openDirection:r,showOptions:l}=Y(e),c=t.isOpen,y=t.isPointed,v=t.isSelected,d=t.isDisabled,h=t.isActive,B=t.canPointGroups,T=t.resolving,I=t.fo,P=w(()=>({container:"multiselect",containerDisabled:"is-disabled",containerOpen:"is-open",containerOpenTop:"is-open-top",containerActive:"is-active",wrapper:"multiselect-wrapper",singleLabel:"multiselect-single-label",singleLabelText:"multiselect-single-label-text",multipleLabel:"multiselect-multiple-label",search:"multiselect-search",tags:"multiselect-tags",tag:"multiselect-tag",tagDisabled:"is-disabled",tagRemove:"multiselect-tag-remove",tagRemoveIcon:"multiselect-tag-remove-icon",tagsSearchWrapper:"multiselect-tags-search-wrapper",tagsSearch:"multiselect-tags-search",tagsSearchCopy:"multiselect-tags-search-copy",placeholder:"multiselect-placeholder",caret:"multiselect-caret",caretOpen:"is-open",clear:"multiselect-clear",clearIcon:"multiselect-clear-icon",spinner:"multiselect-spinner",inifinite:"multiselect-inifite",inifiniteSpinner:"multiselect-inifite-spinner",dropdown:"multiselect-dropdown",dropdownTop:"is-top",dropdownHidden:"is-hidden",options:"multiselect-options",optionsTop:"is-top",group:"multiselect-group",groupLabel:"multiselect-group-label",groupLabelPointable:"is-pointable",groupLabelPointed:"is-pointed",groupLabelSelected:"is-selected",groupLabelDisabled:"is-disabled",groupLabelSelectedPointed:"is-selected is-pointed",groupLabelSelectedDisabled:"is-selected is-disabled",groupOptions:"multiselect-group-options",option:"multiselect-option",optionPointed:"is-pointed",optionSelected:"is-selected",optionDisabled:"is-disabled",optionSelectedPointed:"is-selected is-pointed",optionSelectedDisabled:"is-selected is-disabled",noOptions:"multiselect-no-options",noResults:"multiselect-no-results",fakeInput:"multiselect-fake-input",assist:"multiselect-assistive-text",spacer:"multiselect-spacer",...n.value})),q=w(()=>!!(c.value&&l.value&&(!T.value||T.value&&I.value.length)));return{classList:w(()=>{const f=P.value;return{container:[f.container].concat(i.value?f.containerDisabled:[]).concat(q.value&&r.value==="top"?f.containerOpenTop:[]).concat(q.value&&r.value!=="top"?f.containerOpen:[]).concat(h.value?f.containerActive:[]),wrapper:f.wrapper,spacer:f.spacer,singleLabel:f.singleLabel,singleLabelText:f.singleLabelText,multipleLabel:f.multipleLabel,search:f.search,tags:f.tags,tag:[f.tag].concat(i.value?f.tagDisabled:[]),tagDisabled:f.tagDisabled,tagRemove:f.tagRemove,tagRemoveIcon:f.tagRemoveIcon,tagsSearchWrapper:f.tagsSearchWrapper,tagsSearch:f.tagsSearch,tagsSearchCopy:f.tagsSearchCopy,placeholder:f.placeholder,caret:[f.caret].concat(c.value?f.caretOpen:[]),clear:f.clear,clearIcon:f.clearIcon,spinner:f.spinner,inifinite:f.inifinite,inifiniteSpinner:f.inifiniteSpinner,dropdown:[f.dropdown].concat(r.value==="top"?f.dropdownTop:[]).concat(!c.value||!l.value||!q.value?f.dropdownHidden:[]),options:[f.options].concat(r.value==="top"?f.optionsTop:[]),group:f.group,groupLabel:A=>{let F=[f.groupLabel];return y(A)?F.push(v(A)?f.groupLabelSelectedPointed:f.groupLabelPointed):v(A)&&B.value?F.push(d(A)?f.groupLabelSelectedDisabled:f.groupLabelSelected):d(A)&&F.push(f.groupLabelDisabled),B.value&&F.push(f.groupLabelPointable),F},groupOptions:f.groupOptions,option:(A,F)=>{let H=[f.option];return y(A)?H.push(v(A)?f.optionSelectedPointed:f.optionPointed):v(A)?H.push(d(A)?f.optionSelectedDisabled:f.optionSelected):(d(A)||F&&d(F))&&H.push(f.optionDisabled),H},noOptions:f.noOptions,noResults:f.noResults,assist:f.assist,fakeInput:f.fakeInput}}),showDropdown:q}}function Ls(e,s,t){const{limit:n,infinite:i}=Y(e),r=t.isOpen,l=t.offset,c=t.search,y=t.pfo,v=t.eo,d=G(null),h=G(null),B=w(()=>l.value<y.value.length),T=P=>{const{isIntersecting:q,target:C}=P[0];if(q){const f=C.offsetParent,A=f.scrollTop;l.value+=n.value==-1?10:n.value,Pe(()=>{f.scrollTop=A})}},I=()=>{r.value&&l.value<y.value.length?d.value.observe(h.value):!r.value&&d.value&&d.value.disconnect()};return le(r,()=>{!i.value||I()}),le(c,()=>{!i.value||(l.value=n.value,I())},{flush:"post"}),le(v,()=>{!i.value||I()},{immediate:!1,flush:"post"}),ut(()=>{window&&window.IntersectionObserver&&(d.value=new IntersectionObserver(T))}),{hasMore:B,infiniteLoader:h}}function Cs(e,s,t){const{placeholder:n,id:i,valueProp:r,label:l,mode:c,groupLabel:y,aria:v,searchable:d}=Y(e),h=t.pointer,B=t.iv,T=t.hasSelected,I=t.multipleLabelText,P=G(null),q=w(()=>{let b=[];return i&&i.value&&b.push(i.value),b.push("assist"),b.join("-")}),C=w(()=>{let b=[];return i&&i.value&&b.push(i.value),b.push("multiselect-options"),b.join("-")}),f=w(()=>{let b=[];if(i&&i.value&&b.push(i.value),h.value)return b.push(h.value.group?"multiselect-group":"multiselect-option"),b.push(h.value.group?h.value.index:h.value[r.value]),b.join("-")}),A=w(()=>n.value),F=w(()=>c.value!=="single"),H=w(()=>{let b="";return c.value==="single"&&T.value&&(b+=B.value[l.value]),c.value==="multiple"&&T.value&&(b+=I.value),c.value==="tags"&&T.value&&(b+=B.value.map(E=>E[l.value]).join(", ")),b}),O=w(()=>{let b={...v.value};return d.value&&(b["aria-labelledby"]=b["aria-labelledby"]?`${q.value} ${b["aria-labelledby"]}`:q.value,H.value&&b["aria-label"]&&(b["aria-label"]=`${H.value}, ${b["aria-label"]}`)),b}),V=b=>{let E=[];return i&&i.value&&E.push(i.value),E.push("multiselect-option"),E.push(b[r.value]),E.join("-")},W=b=>{let E=[];return i&&i.value&&E.push(i.value),E.push("multiselect-group"),E.push(b.index),E.join("-")},K=b=>{let E=[];return E.push(b),E.join(" ")},J=b=>{let E=[];return E.push(b),E.join(" ")},te=b=>`${b} \u274E`;return ut(()=>{if(i&&i.value&&document&&document.querySelector){let b=document.querySelector(`[for="${i.value}"]`);P.value=b?b.innerText:null}}),{arias:O,ariaLabel:H,ariaAssist:q,ariaControls:C,ariaPlaceholder:A,ariaMultiselectable:F,ariaActiveDescendant:f,ariaOptionId:V,ariaOptionLabel:K,ariaGroupId:W,ariaGroupLabel:J,ariaTagLabel:te}}function Ts(e,s,t){const{locale:n,fallbackLocale:i}=Y(e);return{localize:l=>!l||typeof l!="object"?l:l&&l[n.value]?l[n.value]:l&&n.value&&l[n.value.toUpperCase()]?l[n.value.toUpperCase()]:l&&l[i.value]?l[i.value]:l&&i.value&&l[i.value.toUpperCase()]?l[i.value.toUpperCase()]:l&&Object.keys(l)[0]?l[Object.keys(l)[0]]:""}}function $s(e,s,t,n={}){return t.forEach(i=>{i&&(n={...n,...i(e,s,n)})}),n}var Ye={name:"Multiselect",emits:["paste","open","close","select","deselect","input","search-change","tag","option","update:modelValue","change","clear","keydown","keyup","max","create"],props:{value:{required:!1},modelValue:{required:!1},options:{type:[Array,Object,Function],required:!1,default:()=>[]},id:{type:[String,Number],required:!1},name:{type:[String,Number],required:!1,default:"multiselect"},disabled:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:"label"},trackBy:{type:String,required:!1,default:void 0},valueProp:{type:String,required:!1,default:"value"},placeholder:{type:String,required:!1,default:null},mode:{type:String,required:!1,default:"single"},searchable:{type:Boolean,required:!1,default:!1},limit:{type:Number,required:!1,default:-1},hideSelected:{type:Boolean,required:!1,default:!0},createTag:{type:Boolean,required:!1,default:void 0},createOption:{type:Boolean,required:!1,default:void 0},appendNewTag:{type:Boolean,required:!1,default:void 0},appendNewOption:{type:Boolean,required:!1,default:void 0},addTagOn:{type:Array,required:!1,default:void 0},addOptionOn:{type:Array,required:!1,default:void 0},caret:{type:Boolean,required:!1,default:!0},loading:{type:Boolean,required:!1,default:!1},noOptionsText:{type:[String,Object],required:!1,default:"The list is empty"},noResultsText:{type:[String,Object],required:!1,default:"No results found"},multipleLabel:{type:Function,required:!1},object:{type:Boolean,required:!1,default:!1},delay:{type:Number,required:!1,default:-1},minChars:{type:Number,required:!1,default:0},resolveOnLoad:{type:Boolean,required:!1,default:!0},filterResults:{type:Boolean,required:!1,default:!0},clearOnSearch:{type:Boolean,required:!1,default:!1},clearOnSelect:{type:Boolean,required:!1,default:!0},canDeselect:{type:Boolean,required:!1,default:!0},canClear:{type:Boolean,required:!1,default:!0},max:{type:Number,required:!1,default:-1},showOptions:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:!1},openDirection:{type:String,required:!1,default:"bottom"},nativeSupport:{type:Boolean,required:!1,default:!1},classes:{type:Object,required:!1,default:()=>({})},strict:{type:Boolean,required:!1,default:!0},closeOnSelect:{type:Boolean,required:!1,default:!0},closeOnDeselect:{type:Boolean,required:!1,default:!1},autocomplete:{type:String,required:!1},groups:{type:Boolean,required:!1,default:!1},groupLabel:{type:String,required:!1,default:"label"},groupOptions:{type:String,required:!1,default:"options"},groupHideEmpty:{type:Boolean,required:!1,default:!1},groupSelect:{type:Boolean,required:!1,default:!0},inputType:{type:String,required:!1,default:"text"},attrs:{required:!1,type:Object,default:()=>({})},onCreate:{required:!1,type:Function},disabledProp:{type:String,required:!1,default:"disabled"},searchStart:{type:Boolean,required:!1,default:!1},reverse:{type:Boolean,required:!1,default:!1},regex:{type:[Object,String,RegExp],required:!1,default:void 0},rtl:{type:Boolean,required:!1,default:!1},infinite:{type:Boolean,required:!1,default:!1},aria:{required:!1,type:Object,default:()=>({})},clearOnBlur:{required:!1,type:Boolean,default:!0},locale:{required:!1,type:String,default:null},fallbackLocale:{required:!1,type:String,default:"en"},searchFilter:{required:!1,type:Function,default:null},allowAbsent:{required:!1,type:Boolean,default:!1}},setup(e,s){return $s(e,s,[Ts,hs,ms,Os,ps,vs,Ss,bs,Ls,ks,_s,ws,Cs])}};const Bs=["id","dir"],Is=["tabindex","aria-controls","aria-placeholder","aria-expanded","aria-activedescendant","aria-multiselectable","role"],Es=["type","modelValue","value","autocomplete","id","aria-controls","aria-placeholder","aria-expanded","aria-activedescendant","aria-multiselectable"],Ps=["onKeyup","aria-label"],Rs=["onClick"],Ns=["type","modelValue","value","id","autocomplete","aria-controls","aria-placeholder","aria-expanded","aria-activedescendant","aria-multiselectable"],As=["innerHTML"],qs=["id"],Ds=["id","aria-label","aria-selected"],Ms=["data-pointed","onMouseenter","onClick"],Ks=["innerHTML"],Fs=["aria-label"],zs=["data-pointed","data-selected","onMouseenter","onClick","id","aria-selected","aria-label"],Vs=["data-pointed","data-selected","onMouseenter","onClick","id","aria-selected","aria-label"],js=["innerHTML"],Gs=["innerHTML"],Hs=["value"],Ws=["name","value"],Us=["name","value"],Qs=["id"];function Zs(e,s,t,n,i,r){return p(),m("div",{ref:"multiselect",class:L(e.classList.container),id:t.searchable?void 0:t.id,dir:t.rtl?"rtl":void 0,onFocusin:s[10]||(s[10]=(...l)=>e.handleFocusIn&&e.handleFocusIn(...l)),onFocusout:s[11]||(s[11]=(...l)=>e.handleFocusOut&&e.handleFocusOut(...l)),onKeyup:s[12]||(s[12]=(...l)=>e.handleKeyup&&e.handleKeyup(...l)),onKeydown:s[13]||(s[13]=(...l)=>e.handleKeydown&&e.handleKeydown(...l))},[g("div",Ge({class:e.classList.wrapper,onMousedown:s[9]||(s[9]=(...l)=>e.handleMousedown&&e.handleMousedown(...l)),ref:"wrapper",tabindex:e.tabindex,"aria-controls":t.searchable?void 0:e.ariaControls,"aria-placeholder":t.searchable?void 0:e.ariaPlaceholder,"aria-expanded":t.searchable?void 0:e.isOpen,"aria-activedescendant":t.searchable?void 0:e.ariaActiveDescendant,"aria-multiselectable":t.searchable?void 0:e.ariaMultiselectable,role:t.searchable?void 0:"combobox"},t.searchable?{}:e.arias),[S(" Search "),t.mode!=="tags"&&t.searchable&&!t.disabled?(p(),m("input",Ge({key:0,type:t.inputType,modelValue:e.search,value:e.search,class:e.classList.search,autocomplete:t.autocomplete,id:t.searchable?t.id:void 0,onInput:s[0]||(s[0]=(...l)=>e.handleSearchInput&&e.handleSearchInput(...l)),onKeypress:s[1]||(s[1]=(...l)=>e.handleKeypress&&e.handleKeypress(...l)),onPaste:s[2]||(s[2]=He((...l)=>e.handlePaste&&e.handlePaste(...l),["stop"])),ref:"input","aria-controls":e.ariaControls,"aria-placeholder":e.ariaPlaceholder,"aria-expanded":e.isOpen,"aria-activedescendant":e.ariaActiveDescendant,"aria-multiselectable":e.ariaMultiselectable,role:"combobox"},{...t.attrs,...e.arias}),null,16,Es)):S("v-if",!0),S(" Tags (with search) "),t.mode=="tags"?(p(),m("div",{key:1,class:L(e.classList.tags),"data-tags":""},[(p(!0),m(ee,null,ae(e.iv,(l,c,y)=>Z(e.$slots,"tag",{option:l,handleTagRemove:e.handleTagRemove,disabled:t.disabled},()=>[(p(),m("span",{class:L([e.classList.tag,l.disabled?e.classList.tagDisabled:null]),tabindex:"-1",onKeyup:Qe(v=>e.handleTagRemove(l,v),["enter"]),key:y,"aria-label":e.ariaTagLabel(e.localize(l[t.label]))},[Ze(j(e.localize(l[t.label]))+" ",1),!t.disabled&&!l.disabled?(p(),m("span",{key:0,class:L(e.classList.tagRemove),onClick:He(v=>e.handleTagRemove(l,v),["stop"])},[g("span",{class:L(e.classList.tagRemoveIcon)},null,2)],10,Rs)):S("v-if",!0)],42,Ps))])),256)),g("div",{class:L(e.classList.tagsSearchWrapper),ref:"tags"},[S(" Used for measuring search width "),g("span",{class:L(e.classList.tagsSearchCopy)},j(e.search),3),S(" Actual search input "),t.searchable&&!t.disabled?(p(),m("input",Ge({key:0,type:t.inputType,modelValue:e.search,value:e.search,class:e.classList.tagsSearch,id:t.searchable?t.id:void 0,autocomplete:t.autocomplete,onInput:s[3]||(s[3]=(...l)=>e.handleSearchInput&&e.handleSearchInput(...l)),onKeypress:s[4]||(s[4]=(...l)=>e.handleKeypress&&e.handleKeypress(...l)),onPaste:s[5]||(s[5]=He((...l)=>e.handlePaste&&e.handlePaste(...l),["stop"])),ref:"input","aria-controls":e.ariaControls,"aria-placeholder":e.ariaPlaceholder,"aria-expanded":e.isOpen,"aria-activedescendant":e.ariaActiveDescendant,"aria-multiselectable":e.ariaMultiselectable,role:"combobox"},{...t.attrs,...e.arias}),null,16,Ns)):S("v-if",!0)],2)],2)):S("v-if",!0),S(" Single label "),t.mode=="single"&&e.hasSelected&&!e.search&&e.iv?Z(e.$slots,"singlelabel",{key:2,value:e.iv},()=>[g("div",{class:L(e.classList.singleLabel)},[g("span",{class:L(e.classList.singleLabelText)},j(e.localize(e.iv[t.label])),3)],2)]):S("v-if",!0),S(" Multiple label "),t.mode=="multiple"&&e.hasSelected&&!e.search?Z(e.$slots,"multiplelabel",{key:3,values:e.iv},()=>[g("div",{class:L(e.classList.multipleLabel),innerHTML:e.multipleLabelText},null,10,As)]):S("v-if",!0),S(" Placeholder "),t.placeholder&&!e.hasSelected&&!e.search?Z(e.$slots,"placeholder",{key:4},()=>[g("div",{class:L(e.classList.placeholder),"aria-hidden":"true"},j(t.placeholder),3)]):S("v-if",!0),S(" Spinner "),t.loading||e.resolving?Z(e.$slots,"spinner",{key:5},()=>[g("span",{class:L(e.classList.spinner),"aria-hidden":"true"},null,2)]):S("v-if",!0),S(" Clear "),e.hasSelected&&!t.disabled&&t.canClear&&!e.busy?Z(e.$slots,"clear",{key:6,clear:e.clear},()=>[g("span",{"aria-hidden":"true",tabindex:"0",role:"button","data-clear":"","aria-roledescription":"\u274E",class:L(e.classList.clear),onClick:s[6]||(s[6]=(...l)=>e.clear&&e.clear(...l)),onKeyup:s[7]||(s[7]=Qe((...l)=>e.clear&&e.clear(...l),["enter"]))},[g("span",{class:L(e.classList.clearIcon)},null,2)],34)]):S("v-if",!0),S(" Caret "),t.caret&&t.showOptions?Z(e.$slots,"caret",{key:7},()=>[g("span",{class:L(e.classList.caret),onClick:s[8]||(s[8]=(...l)=>e.handleCaretClick&&e.handleCaretClick(...l)),"aria-hidden":"true"},null,2)]):S("v-if",!0)],16,Is),S(" Options "),g("div",{class:L(e.classList.dropdown),tabindex:"-1"},[Z(e.$slots,"beforelist",{options:e.fo}),g("ul",{class:L(e.classList.options),id:e.ariaControls,role:"listbox"},[t.groups?(p(!0),m(ee,{key:0},ae(e.fg,(l,c,y)=>(p(),m("li",{class:L(e.classList.group),key:y,id:e.ariaGroupId(l),"aria-label":e.ariaGroupLabel(e.localize(l[t.groupLabel])),"aria-selected":e.isSelected(l),role:"option"},[l.__CREATE__?S("v-if",!0):(p(),m("div",{key:0,class:L(e.classList.groupLabel(l)),"data-pointed":e.isPointed(l),onMouseenter:v=>e.setPointer(l,c),onClick:v=>e.handleGroupClick(l)},[Z(e.$slots,"grouplabel",{group:l,isSelected:e.isSelected,isPointed:e.isPointed},()=>[g("span",{innerHTML:e.localize(l[t.groupLabel])},null,8,Ks)])],42,Ms)),g("ul",{class:L(e.classList.groupOptions),"aria-label":e.ariaGroupLabel(e.localize(l[t.groupLabel])),role:"group"},[(p(!0),m(ee,null,ae(l.__VISIBLE__,(v,d,h)=>(p(),m("li",{class:L(e.classList.option(v,l)),"data-pointed":e.isPointed(v),"data-selected":e.isSelected(v)||void 0,key:h,onMouseenter:B=>e.setPointer(v),onClick:B=>e.handleOptionClick(v),id:e.ariaOptionId(v),"aria-selected":e.isSelected(v),"aria-label":e.ariaOptionLabel(e.localize(v[t.label])),role:"option"},[Z(e.$slots,"option",{option:v,isSelected:e.isSelected,isPointed:e.isPointed,search:e.search},()=>[g("span",null,j(e.localize(v[t.label])),1)])],42,zs))),128))],10,Fs)],10,Ds))),128)):(p(!0),m(ee,{key:1},ae(e.fo,(l,c,y)=>(p(),m("li",{class:L(e.classList.option(l)),"data-pointed":e.isPointed(l),"data-selected":e.isSelected(l)||void 0,key:y,onMouseenter:v=>e.setPointer(l),onClick:v=>e.handleOptionClick(l),id:e.ariaOptionId(l),"aria-selected":e.isSelected(l),"aria-label":e.ariaOptionLabel(e.localize(l[t.label])),role:"option"},[Z(e.$slots,"option",{option:l,isSelected:e.isSelected,isPointed:e.isPointed,search:e.search},()=>[g("span",null,j(e.localize(l[t.label])),1)])],42,Vs))),128))],10,qs),e.noOptions?Z(e.$slots,"nooptions",{key:0},()=>[g("div",{class:L(e.classList.noOptions),innerHTML:e.localize(t.noOptionsText)},null,10,js)]):S("v-if",!0),e.noResults?Z(e.$slots,"noresults",{key:1},()=>[g("div",{class:L(e.classList.noResults),innerHTML:e.localize(t.noResultsText)},null,10,Gs)]):S("v-if",!0),t.infinite&&e.hasMore?(p(),m("div",{key:2,class:L(e.classList.inifinite),ref:"infiniteLoader"},[Z(e.$slots,"infinite",{},()=>[g("span",{class:L(e.classList.inifiniteSpinner)},null,2)])],2)):S("v-if",!0),Z(e.$slots,"afterlist",{options:e.fo})],2),S(" Hacky input element to show HTML5 required warning "),t.required?(p(),m("input",{key:0,class:L(e.classList.fakeInput),tabindex:"-1",value:e.textValue,required:""},null,10,Hs)):S("v-if",!0),S(" Native input support "),t.nativeSupport?(p(),m(ee,{key:1},[t.mode=="single"?(p(),m("input",{key:0,type:"hidden",name:t.name,value:e.plainValue!==void 0?e.plainValue:""},null,8,Ws)):(p(!0),m(ee,{key:1},ae(e.plainValue,(l,c)=>(p(),m("input",{type:"hidden",name:`${t.name}[]`,value:l,key:c},null,8,Us))),128))],64)):S("v-if",!0),S(" Screen reader assistive text "),t.searchable&&e.hasSelected?(p(),m("div",{key:2,class:L(e.classList.assist),id:e.ariaAssist,"aria-hidden":"true"},j(e.ariaLabel),11,Qs)):S("v-if",!0),S(" Create height for empty input "),g("div",{class:L(e.classList.spacer)},null,2)],42,Bs)}Ye.render=Zs;Ye.__file="src/Multiselect.vue";const Js={name:"sorter",props:["label","currentList","listName","item","index","tippyTop"],mixins:[Pt],components:{VueSlider:Rt,Multiselect:Ye},data:function(){return{range:null,dropdownOptions:null}},created:function(){if(this.item.range){var e={min:this.item.rangeMin(),max:this.item.rangeMax()};e.min<0&&(e.min=0),e.max<0&&(e.max=0),e.min>e.max&&(e.min=e.max),_.isArray(this.item.range)?(e.value=_.clone(this.item.range),(e.value[0]<e.min||e.value[0]>e.max)&&(e.value[0]=e.min),(e.value[1]<e.min||e.value[1]>e.max)&&(e.value[1]=e.max)):e.value=[e.min,e.max],this.item.rangeMarks&&(e.marks=this.item.rangeMarks(e)),this.range=e}else this.$store.getters.filterExtrasKeys.match(this.item.key)&&!this.dropdownOptions&&!!this.item.dropdownOpts&&(this.dropdownOptions=this.item.dropdownOpts())},computed:{filterBooks:function(){this.$compEmitter.emit("repositionSearchOpts");let e=!(this.item.range||this.item.dropdownOpts),s=!e&&this.item.active===!0;if(e||s){const t=this,n=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filterExtras",active:!0});let i=function(l){let c=_.map(n,function(y){return!!y.condition(l,y)});return!_.includes(c,!1)},r=this.item.type==="filter"?this.$store.getters.searchIsActive?this.$store.state.searchCollection:this.$store.getters.collectionSource:this.$store.getters.collection;return _.filter(r,function(l){return t.item.condition(l)&&i(l)})}else return[]},filterAmounts:function(){return this.filterBooks.length},rangeVal:function(){return this.range.value},inputVmodel:{get:function(){return this.item.active},set:function(e){let s={listName:this.listName,key:this.item.key,active:e};this.item.range&&(s.range=e?_.clone(this.range.value):!0),this.item.group&&(s.group=!0),this.$store.commit("updateListRenderingOpts",s),this.doTheThings(e)}},isActiveSortItem:function(){if(this.listName==="sort"){if(!this.$store.getters.searchIsActive||this.$store.getters.searchIsActive&&this.$route.query.sort)return _.findIndex(this.currentList,"current")===this.index}else if(this.listName==="filter")return!1}},methods:{tooltipFormatter:function(e){return e+this.item.rangeSuffix},dropdownChanged:function(e){let s={listName:this.listName,key:this.item.key,active:e.length>0,value:e};this.item.group&&(s.group=!0),this.$store.commit("updateListRenderingOpts",s),this.doTheThings(e,!0)},dropdownOpened:function(e){!this.dropdownOptions&&!!this.item.dropdownOpts&&(this.dropdownOptions=this.item.dropdownOpts())},rangeChanged:function(e){this.range.value=e;let s={listName:this.listName,key:this.item.key,range:e,active:!0};this.item.group&&(s.group=!0),this.$store.commit("updateListRenderingOpts",s),this.doTheThings(e,!0)},adjustRange:function(e){let s={listName:this.listName,key:this.item.key,active:!0,range:[0,0]};if(e==="left"){const t=this.range.min;s.range[0]=t,this.range.value=[t,this.range.value[1]]}else{const t=this.range.max;s.range[1]=t,this.range.value=[this.range.value[0],t]}this.item.group&&(s.group=!0),this.$store.commit("updateListRenderingOpts",s),this.doTheThings(s.range,!0)},doTheThings:function(e,s){const t={change:{scope:this.listName==="scope",sort:this.listName==="sort",filter:this.listName==="filter"},randomize:this.item.key==="randomize"&&!this.$store.getters.searchIsActive,noSortvalues:this.item.key!=="sortValues",start:""};t.change.scope?t.start="start-scope":(t.change.sort||t.randomize)&&t.noSortvalues?(this.$store.commit("prop",{key:"searchSort",value:!1}),t.start="start-sort"):t.change.filter&&(t.start="start-filter"),this.saveOptions(e,s),this.$compEmitter.emit(t.start)},saveOptions:function(e,s){const t=this.item.key,n=this.item.type,i={};if(t==="sortValues")i[t]=e;else if(n==="sort")i[n]=t,i.sortDir=e?"desc":"asc";else if(this.listName==="filter"){if(n==="filter"&&(i[n]=encodeURIComponent(this.$store.getters.filterKeys)),n==="filterExtras"){this.$route.name==="series"&&t.match(/inLibrary|notInLibrary/)&&this.$store.commit("prop",{key:"sticky.seriesFilters."+t,value:e});let r=this;const l=r.$store.getters.filterExtrasKeys,c=l?_.map(l.split(","),function(y){const v=_.find(r.$store.state.listRenderingOpts.filter,{key:y});let d=_.get(r.range,"value");if(d||(d=_.get(v,"range")),d&&_.isArray(d))return encodeURIComponent(y+":"+d[0]+"-"+(d[1]||d[0]));if(_.get(v,"value.0"))return encodeURIComponent(y+":")+encodeURIComponent(_.map(v.value,function(h){return h}).join("|"));if(y)return encodeURIComponent(y)}):!1;i[n]=_.isArray(c)?c.join(", "):null}}else this.listName==="scope"&&(i[this.listName]=encodeURIComponent(this.$store.getters.scopeKeys));i.book=null,this.$store.commit("prop",{key:"bookClicked",value:!0}),this.$updateQueries(i,{src:"saveOptions"})}}},Xs={class:"sorter-button-wrapper"},Ys=["content"],xs=["value"],ea={key:2,class:"radiobutton"},ta={key:3,class:"checkbox"},sa={key:0,class:"dropdown-label-suffix"},aa={key:0,class:"label-exclude"},la={key:1,class:"label-include"},ia={key:5,class:"books-in-filter"},na={key:0,class:"range-slider"},ra={key:1};function oa(e,s,t,n,i,r){const l=fs,c=rs,y=ss,v=Xt,d=Wt,h=Nt,B=ot("vue-slider"),T=ot("Multiselect"),I=Je("tippy");return p(),m("span",Xs,[t.item?ke((p(),m("span",{key:0,class:L(t.item.key),content:t.item.tippy?t.item.tippy:!1},[g("label",{class:L(["sorter-button",{ranged:t.item.range,"faux-disabled":t.item.type==="filterExtras"?r.filterAmounts<1:!1,"is-dropdown":t.item.dropdownOpts}])},[t.label===!1?(p(),m("span",{key:0,class:L(["input-label",{active:r.isActiveSortItem}])},[Z(e.$slots,"default",{},void 0,!0)],2)):S("",!0),ke(g("input",{type:"checkbox",value:t.index,"onUpdate:modelValue":s[0]||(s[0]=P=>r.inputVmodel=P)},null,8,xs),[[qt,r.inputVmodel]]),t.item.type==="sort"?(p(),m("span",{key:1,class:L(["sortbox",{active:r.isActiveSortItem}])},[x(l,{"data-icon":"sort-down"}),x(c,{"data-icon":"sort-up"})],2)):t.item.radiobutton?(p(),m("span",ea,[x(y,{"data-icon":"circle"}),x(v,{"data-icon":"circle"})])):(p(),m("span",ta,[x(d,{"data-icon":"square"}),x(h,{"data-icon":"check"})])),t.label!==!1?(p(),m("span",{key:4,class:L(["input-label",{active:r.isActiveSortItem}])},[g("span",null,[Ze(j(t.item.label||t.item.key.replace(".name",""))+" ",1),t.item.dropdownOpts?(p(),m("span",sa,[t.item.exclude?(p(),m("span",aa,"Exclude")):(p(),m("span",la,"Include"))])):S("",!0)])],2)):S("",!0),t.listName==="filter"?(p(),m("span",ia,j(r.filterAmounts)+" ",1)):S("",!0)],2),t.item.range?(p(),m("div",na,[g("span",{style:{"font-size":"13px","line-height":"13px",cursor:"w-resize"},onClick:s[1]||(s[1]=P=>r.adjustRange("left"))},j(e.range.value[0])+j(t.item.rangeSuffix),1),x(B,{disabled:e.range.disabled,dragOnClick:!0,adsorb:!0,lazy:!0,hideLabel:!0,included:!!e.range.marks,interval:e.range.min===e.range.max?1:t.item.rangeInterval||1,marks:e.range.marks,modelValue:e.range.value,min:e.range.min,max:e.range.max,"min-range":e.range.min===e.range.max?0:t.item.rangeMinDist||0,"enable-cross":!1,onChange:r.rangeChanged,"tooltip-formatter":t.item.tooltipFormatter||r.tooltipFormatter,"tooltip-placement":"top",tooltip:"active","use-keyboard":!1,onDragStart:s[2]||(s[2]=P=>e.$store.commit("prop",{key:"searchOptCloseGuard",value:!0})),onDragEnd:s[3]||(s[3]=P=>e.$store.commit("prop",{key:"searchOptCloseGuard",value:!1}))},null,8,["disabled","included","interval","marks","modelValue","min","max","min-range","onChange","tooltip-formatter"]),g("span",{style:{"font-size":"13px","line-height":"13px",cursor:"e-resize"},onClick:s[4]||(s[4]=P=>r.adjustRange("right"))},j(e.range.value[1])+j(t.item.rangeSuffix),1)])):S("",!0),t.item.dropdownOpts?(p(),m("div",ra,[x(T,{ref:"multiselect",value:t.item.value,placeholder:t.item.placeholder||"Include...",onChange:r.dropdownChanged,onOpen:r.dropdownOpened,options:e.dropdownOptions,mode:"tags",hideSelected:!0,clearOnSelect:!1,closeOnSelect:!1,multiple:!0,taggable:!0,searchable:!0,"track-by":t.item.dropdownTrackBy,label:t.item.dropdownLabel,valueProp:t.item.dropdownValueProp},null,8,["value","placeholder","onChange","onOpen","options","track-by","label","valueProp"])])):S("",!0)],10,Ys)),[[I,{delay:150,maxWidth:350,placement:t.tippyTop?"top":"left",flipBehavior:t.tippyTop?["top","bottom","left","right"]:["left","top","bottom","right"],distance:t.listName?20:10}]]):S("",!0)])}var ua=Ne(Js,[["render",oa],["__scopeId","data-v-022cc42e"]]);const ca={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},da=g("path",{fill:"currentColor",d:"M256.455 8c66.269.119 126.437 26.233 170.859 68.685l35.715-35.715C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.75c-30.864-28.899-70.801-44.907-113.23-45.273c-92.398-.798-170.283 73.977-169.484 169.442C88.764 348.009 162.184 424 256 424c41.127 0 79.997-14.678 110.629-41.556c4.743-4.161 11.906-3.908 16.368.553l39.662 39.662c4.872 4.872 4.631 12.815-.482 17.433C378.202 479.813 319.926 504 256 504C119.034 504 8.001 392.967 8 256.002C7.999 119.193 119.646 7.755 256.455 8z"},null,-1),fa=[da];function va(e,s){return p(),m("svg",ca,fa)}var ha={name:"fa-solid-redo-alt",render:va};const pa={name:"searchOptions",props:["listName"],data:function(){return{css:{arrow:{left:"0px"},options:{right:"0px"}}}},computed:{mainfilters(){const e=this.$route.name==="wishlist",s=this.$route.name==="series",t=this.$route.name==="podcasts";return _.filter(this.optionsList,n=>this.allTrue({"is regular filter":n.type==="filter","exclude from wishlist":e?!n.excludeFromWishlist:!0,"exclude from series subpage":s?!n.excludeFromSeriesSubPage:!0,"exclude from podcasts":t?!n.excludeFromPodcasts:!0}))},filteredOptionsList(){const e=this.$route.name==="wishlist",s=this.$route.name==="series",t=this.$route.name==="podcasts",n=this.$store.state.sticky.viewMode!=="grid";return _.filter(this.optionsList,i=>this.allTrue({"no sort values in list view":!(n&&i.key==="sortValues"),"is not a regular filter":i.type!=="filter","exclude from wishlist":e?!i.excludeFromWishlist:!0,"exclude from series subpage":s?!i.excludeFromSeriesSubPage:!0,"exclude from podcasts":t?!i.excludeFromPodcasts:!0}))}},created:function(){this.$store.commit("prop",{key:"lazyScroll",value:!1}),this.$updateQueries({y:null}),this.optionsList=this.$store.state.listRenderingOpts[this.listName]},mounted:function(){this.repositionSearchOptions(),this.$compEmitter.on("repositionSearchOpts",this.repositionSearchOptions),this.$compEmitter.on("afterWindowResize",this.repositionSearchOptions)},beforeUnmount:function(){this.$compEmitter.off("repositionSearchOpts",this.repositionSearchOptions),this.$compEmitter.off("afterWindowResize",this.repositionSearchOptions),scroll({top:0,behavior:"smooth"}),this.$store.commit("prop",{key:"searchOptOpenHeight",value:null}),this.$store.commit("prop",{key:"lazyScroll",value:!0})},methods:{allTrue(e){return e=_.values(e),_.every(e)},resetFilters:function(){this.$updateQueries({filter:null,filterExtras:null}),this.$store.commit("resetFilters"),this.$compEmitter.emit("start-filter")},repositionSearchOptions:_.debounce(function(){this.$nextTick(function(){const e={};e.el=this.$refs.options,e.width=e.el.offsetWidth,e.left=e.el.offsetLeft;const s={};s.el=document.querySelector("#ale-search > .icons"),s.width=s.el.offsetWidth;const t={};t.el=document.querySelector(".search-opt-btn.active").parentNode,t.width=t.el.offsetWidth,t.left=t.el.offsetLeft,t.middle=s.width-(t.left+t.width/2),e.position=t.middle-e.width/2;const n=t.el.getBoundingClientRect().left+t.width/2+e.width/2-window.innerWidth,i=n>0?n+20:0;this.css.options.right=e.position+i+"px",this.css.arrow.left=e.width/2-10+i+"px"})},150,{leading:!0,trailing:!1}),sortersMounted:_.debounce(function(){if(this.$refs.options){let e=this.$refs.options.offsetHeight+this.$refs.options.offsetTop;window.innerHeight>e?e=window.innerHeight:e=e+100,this.$store.commit("prop",{key:"searchOptOpenHeight",value:e})}},250,{leading:!1,trailing:!0})}},ma={class:"search-options-inner-wrap"},ga={class:"total"};function ya(e,s,t,n,i,r){const l=ha,c=ua,y=Je("tippy");return p(),m("div",{id:"search-options",ref:"options",class:L(t.listName+"-options"),style:We(e.css.options)},[g("div",ma,[g("div",{class:"search-opts-arrow",style:We(e.css.arrow)},null,4),t.listName==="filter"&&e.$store.getters.regularFilters?(p(),m("ul",{key:0,class:"regular-filters",style:We({top:e.$store.state.topNavOffset+"px"})},[ke((p(),m("li",{class:"reset-filters",onClick:s[0]||(s[0]=(...v)=>r.resetFilters&&r.resetFilters(...v)),content:"Reset filters"},[x(l)])),[[y,{placement:"top",flipBehavior:["top","right","bottom","left"]}]]),g("li",ga,[g("span",{class:L({difference:e.$store.getters.collection.length!==e.$store.getters.collectionTotal})},j(e.$store.getters.collection.length),3),Ze(" / "+j(e.$store.getters.collectionTotal),1)]),(p(!0),m(ee,null,ae(r.mainfilters,(v,d)=>(p(),m("li",{class:"search-option",key:v.key},[x(c,{label:v.label,item:v,index:d,currentList:e.optionsList,listName:t.listName,onVnodeMounted:r.sortersMounted},null,8,["label","item","index","currentList","listName","onVnodeMounted"])]))),128))],4)):S("",!0),g("ul",null,[(p(!0),m(ee,null,ae(r.filteredOptionsList,(v,d)=>(p(),m("li",{class:L(["search-option",{extras:v.type&&v.type.match(/extra/i),divider:v.type==="divider"}]),key:v.key},[v.type!=="divider"?(p(),Re(c,{key:0,label:v.label,item:v,index:d,currentList:e.optionsList,listName:t.listName,onVnodeMounted:r.sortersMounted},null,8,["label","item","index","currentList","listName","onVnodeMounted"])):S("",!0)],2))),128))])])],6)}var ba=Ne(pa,[["render",ya]]);const ka={name:"searchIcons",props:["listName"],mixins:[Mt,Xe],data:function(){return{items:[{name:"scope",on:!0,active:!1,icon:"fa-solid fa-microscope",tooltip:"Change the search scope for more accurate results"},{name:"filter",on:!0,active:!1,icon:"fa-solid fa-filter",tooltip:"Filter books"},{name:"sort",on:!0,active:!1,icon:"fa-solid fa-sort",tooltip:"Sort books"}]}},computed:{filtersActive:function(){return this.$store.getters.filterExtrasKeys||this.$store.getters.filterKeys!=="notStarted,started,finished"&&this.$store.getters.filterKeysLength},filteredItems(){return _.filter(this.items,e=>this.showIcon(e))},selectionHours(){let e=_.sumBy(this.$store.getters.collection,s=>s.length?this.timeStringToSeconds(s.length):0);return e&&(e=this.secondsToTimeString(e,!0)),(e||"").trim()}},methods:{openSearchOptions:function(e,s){const t=this.listName;this.$emit("update:listName",!1),t!==e.name&&this.$nextTick(function(){this.$emit("update:listName",e.name)})},showIcon:function(e){if(!!e)switch(e.name){case"scope":return this.$store.state.listRenderingOpts[e.name].length>0;case"filter":let s=!this.$store.getters.regularFilters;return _.filter(this.$store.state.listRenderingOpts[e.name],function(t){let n=t.type==="divider",i=s?!0:t.type===e.name;return!n&&i}).length>0;case"sort":return _.filter(this.$store.state.listRenderingOpts[e.name],function(t){let n=t.type==="divider",i=t.type===e.name;return!n&&i}).length>0}}}},Oa={class:"icons"},Sa=["content"],_a={class:"book-in-selection"},wa={class:"inner-wrap"},La=["content","onClick"],Ca=["data-option"];function Ta(e,s,t,n,i,r){const l=Je("tippy");return p(),m("div",Oa,[ke((p(),m("div",{class:"icon-wrap",content:"Items in current selection: <strong>"+e.$store.getters.collection.length+"</strong> / <strong>"+e.$store.getters.collectionTotal+"</strong>."+(r.selectionHours?"<br> That amounts to: "+r.selectionHours+". ":"")+(e.$route.name==="series"?"Owned books only!":"")},[g("div",_a,[g("div",wa,j(e.$store.getters.collection.length),1)])],8,Sa)),[[l,{trigger:"click mouseenter"}]]),(p(!0),m(ee,null,ae(r.filteredItems,c=>ke((p(),m("div",{key:c.name,class:L(["icon-wrap",{disabled:!c.on}]),content:c.tooltip,onClick:y=>r.openSearchOptions(c,y)},[g("div",{class:L(["search-opt-btn",{active:t.listName===c.name,"active-filters":c.name==="filter"&&r.filtersActive}]),"data-option":c.name},[g("i",{class:L(c.icon)},null,2)],10,Ca)],10,La)),[[l]])),128))])}var $a=Ne(ka,[["render",Ta],["__scopeId","data-v-10b425c4"]]),Ba={methods:{sortName:function(e){return _.orderBy(e.books,function(s){if(s.name)return s.name},e.direction)}}},Ia={methods:{sortIsbns:function(e){return _.orderBy(e.books,function(s){if(s.isbns){if(e.sortKey==="isbn10"){const t=_.find(s.isbns,["type","ISBN_10"]);return t?""+t.identifier:null}else if(e.sortKey==="isbn13"){const t=_.find(s.isbns,["type","ISBN_13"]);return t?""+t.identifier:null}}else return null},e.direction)}}},Ea={methods:{sortTitle:function(e){return _.orderBy(e.books,[function(s){const t=s[e.sortKey];return t?e.sortKey==="title"?s.title||s.titleShort:_.isArray(t)&&_.find(t,"name")?_.map(t,"name").join(", "):t:null}],e.direction)}}},Pa={methods:{sortAmount:function(e){return _.orderBy(e.books,function(s){if(e.sortKey==="amountTotal"){if(s.allBooksMinusDupes)return s.allBooksMinusDupes.length;if(s.allBooks)return s.allBooks.length}else if(s.books)return s.books.length},e.direction)}}},Ra={mixins:[Xe],methods:{sortLength:function(e){const s=this;return _.orderBy(e.books,function(t){return t.length?s.timeStringToSeconds(t.length):0},e.direction)}}},Na={methods:{sortRatings:function(e){const s=e.sortKey,t=[],n=[e.direction];switch(t.push(function(i){const r=_.get(i,s,0);return Number(r)}),s){case"myRating":case"rating":t.push(function(i){const r=_.get(i,"ratings",0);return Number(r)}),n.push(e.direction);break;case"ratings":t.push(function(i){const r=_.get(i,"rating",0);return Number(r)}),n.push(e.direction);break}return _.orderBy(e.books,t,n)}}},Aa={methods:{sortByLength:function(e){return _.orderBy(e.books,function(s){if(e.sortKey==="narratorsNumber")if(s.narrators){let t=_.find(s.narrators,function(n){return n.name.match("full cast")});return t&&s.narrators.length===1?99999999:s.narrators.length-(t?1:0)}else return 0;else return s[e.sortKey].length||0},e.direction)}}},qa={mixins:[Xe],methods:{sortProgress:function(e){var s=this;return _.orderBy(e.books,[function(t){if(t.progress){if(t.progress.toLowerCase().trim()==="finished")return 100;if(t.length){var n=s.timeStringToSeconds(t.progress);const i=s.timeStringToSeconds(t.length);return n=i-n,n/i*100}else return 0}else return 0},function(t){return t.length?!s.timeStringToSeconds(t.length):0}],e.direction)}}},Da={methods:{sortDateAdded:function(e){return _.orderBy(e.books,function(s){return s.added},e.direction)}}},Ma={methods:{sortFavorites:function(e){return _.orderBy(e.books,function(s){return s.favorite},e.direction)}}},Ka={methods:{sortWhispersync:function(e){return _.orderBy(e.books,function(s){const t=s[e.sortKey];if(t){if(t==="owned")return 2;if(t==="available")return 1}else return 0},e.direction)}}},Fa={methods:{sortBookNumbers:function(e){return _.orderBy(e.books,function(s){return s.added},e.direction)},sortBookNumbersOriginal:function(e){const s=this.$route.params.series;return _.orderBy(e.books,function(t){let n=function(i){(_.isEmpty(i)||!i)&&(i=void 0);const r=_.isArray(i)?i[0]:i,l=typeof r=="string"?r.split("-"):[r];return l[0]?parseFloat(l[0]):l[0]};if(s&&t.series){let i=_.find(t.series,{asin:s});return n(i.bookNumbers)}else if(_.find(t.series,"bookNumbers")){let r=_.filter(t.series,"bookNumbers");return r=_.map(r,"bookNumbers"),r=_.flatten(r),n(r)}else return _.find(t.series)?-1:-2},e.direction)}}},za={methods:{sortReleaseDate:function(e){return _.orderBy(e.books,function(s){return s.releaseDate?new Date(s.releaseDate.split("-").join("/")):0},e.direction)}}},Va={methods:{sortStringNameProp:function(e){const s=e.sortKey.replace(".name","");return _.orderBy(e.books,function(t){return t[s]?t[s][0].name.toLowerCase():null},e.direction)}}},ja={methods:{sortMissing:function(e){return _.orderBy(e.books,[s=>s.allBooksMinusDupes?s.allBooksMinusDupes.length-s.books.length:s.allBooks?s.allBooks.length-s.books.length:0,s=>s.myRating],[e.direction,"desc"])}}},Ga={mixins:[Ba,Ia,Ea,Pa,Ra,Na,qa,Aa,Da,Ma,Ka,Fa,za,Va,ja],methods:{filterBooks:function(e){const s=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filter",active:!0}),t=_.find(this.$store.state.listRenderingOpts.filter,{type:"filter"}),n=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filterExtras",active:!0});if(s||n){let i=function(r){let l=_.map(s,function(y){return!!y.condition(r)}),c=_.map(n,function(y){return!!y.condition(r)});return(t?_.includes(l,!0):!0)&&!_.includes(c,!1)};return _.filter(e,i)}else return e},sortBooks:function(e){const s=_.find(this.$store.state.listRenderingOpts.sort,function(t){if(t.key==="randomize"&&t.active)return!0;if(t.current)return!0});if(s){const t={books:e,direction:s.active?"desc":"asc",sortKey:s.key};switch(t.sortKey){case"randomize":e=_.shuffle(e);break;case"bookNumbers":t.missingNumber=0,e=this.sortBookNumbersOriginal(t);break;case"seriesOrder":t.missingNumber=0,e=this.sortBookNumbers(t);break;case"added":e=this.sortDateAdded(t);break;case"releaseDate":e=this.sortReleaseDate(t);break;case"authors.name":case"narrators.name":case"publishers.name":case"categories":case"tags.name":e=this.sortStringNameProp(t);break;case"narratorsNumber":e=this.sortByLength(t);break;case"title":case"series":case"format":case"isNew":case"language":case"fromPlusCatalog":case"unavailable":case"favorite":case"downloaded":case"storePageMissing":case"storePageChanged":case"archived":e=this.sortTitle(t);break;case"whispersync":e=this.sortWhispersync(t);break;case"length":e=this.sortLength(t);break;case"myRating":case"rating":case"ratings":e=this.sortRatings(t);break;case"progress":e=this.sortProgress(t);break;case"favorite":e=this.sortFavorites(t);break;case"name":e=this.sortName(t);break;case"amount":case"amountTotal":e=this.sortAmount(t);break;case"isbn10":case"isbn13":e=this.sortIsbns(t);break;case"missing":e=this.sortMissing(t);break}}return e}}};const Ha={name:"GallerySearch",mixins:[Ga],props:["collectionSource"],data:function(){return{enableZoomTimer:null,fuse:null,fuseOptions:{keys:[],location:0,threshold:.3,ignoreLocation:!0,shouldSort:!0,includeScore:!0,includeMatches:!0,useExtendedSearch:!0,minMatchCharLength:2},listName:!1,waypointOpts:{rootMargin:"-37px"},fixedSearch:!1,highlightSearch:!1,readyToCloseOpts:!1,autocompleteResults:[],useAutocomplete:!1}},mounted:function(){if(this.$route.query.search){let t=decodeURIComponent(this.$route.query.search);this.$store.commit("prop",{key:"searchQuery",value:t})}this.$store.commit("prop",{key:"collectionSource",value:this.collectionSource});let e=this.$store.getters.collectionSource;this.$route.query.sort||this.$route.query.filter||this.$route.query.filterExtras?((this.$route.query.filter||this.$route.query.filterExtras)&&(e=this.filterBooks(e)),this.$route.query.sort&&(e=this.sortBooks(e)),this.$store.commit("prop",{key:"mutatingCollection",value:e})):this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(e))}),this.$route.query.search&&(this.$route.query.sort&&(this.fuseOptions.shouldSort=!1),this.search(null,"on-load")),this.$refs.aleSearch.addEventListener("touchstart",this.iosAutozoomDisable,{passive:!0}),this.$compEmitter.on("ios-auto-zoom-disable",this.iosAutozoomDisable),this.$compEmitter.on("start-scope",this.scope),this.$compEmitter.on("start-sort",this.sort),this.$compEmitter.on("start-filter",this.filter),this.$compEmitter.on("search-focus",this.focusOnSearch),this.$store.commit("prop",{key:"searchMounted",value:!0})},beforeUnmount:function(){this.$store.commit("prop",{key:"searchQuery",value:""}),this.$refs.aleSearch.removeEventListener("touchstart",this.iosAutozoomDisable),this.$compEmitter.off("ios-auto-zoom-disable",this.iosAutozoomDisable),this.$compEmitter.off("start-scope",this.scope),this.$compEmitter.off("start-sort",this.sort),this.$compEmitter.off("start-filter",this.filter),this.$compEmitter.off("search-focus",this.focusOnSearch),this.$store.commit("prop",{key:"searchMounted",value:!1})},methods:{dontCloseOpts:_.throttle(function(){this.readyToCloseOpts&&(this.readyToCloseOpts=!1)},50,{leading:!1,trailing:!0}),closeOpts:function(){this.readyToCloseOpts&&(this.readyToCloseOpts=!1,this.$nextTick(function(){let e=this;setTimeout(function(){e.listName=!1},30)}))},scope:function(){this.$nextTick(()=>{this.$store.getters.searchIsActive&&(this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(this.$store.getters.collectionSource))}),this.$store.getters.searchIsActive||(this.fuseOptions.shouldSort=!1),this.search())})},filter:function(){this.$nextTick(()=>{this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(this.$store.getters.collectionSource))}),this.$store.getters.searchIsActive||(this.fuseOptions.shouldSort=!1),this.$store.getters.searchIsActive&&this.search()})},sort:function(){this.$nextTick(()=>{this.$store.commit("prop",{key:this.$store.getters.searchIsActive?"searchCollection":"mutatingCollection",value:this.sortBooks(this.$store.getters.collection)})})},search:_.debounce(function(e,s){const t={};if(decodeURIComponent(this.$route.query.search),s||(t.book=null,this.$store.commit("prop",{key:"bookClicked",value:!0})),e)if(this.fuseOptions.shouldSort=!0,this.$store.commit("prop",{key:"searchQuery",value:e.target.value}),t.search=encodeURIComponent(e.target.value),t.search||(t.search=null),e.target.value.trim()!=="")this.$route.query.sort&&(t.sort=null,t.sortDir=null);else{var i=_.find(this.$store.state.listRenderingOpts.sort,"current");t.sort=i.key,t.sortDir=i.active?"desc":"asc"}if(this.$updateQueries(t),this.$store.getters.searchIsActive){const r=this.modifyQuery(this.$store.state.searchQuery);this.fuseOptions.keys=this.aliciaKeys;let l=this;l.fuse=new Kt(l.$store.state.mutatingCollection,l.fuseOptions);let c=l.fuse.search(r);l.useAutocomplete&&l.autocomplete(c),c=_.map(c,"item"),l.$store.commit("prop",{key:"searchCollection",value:c})}else this.$store.commit("prop",{key:"searchCollection",value:[]})},270,{leading:!1,trailing:!0}),autocomplete:function(e){let s=_.map(JSON.parse(JSON.stringify(this.aliciaKeys)),function(t,n){return t.key=t.name,t.name=t.name.replace(".name",""),t.active=n<1,t});_.each(e,function(t){_.each(t.matches,function(n){const i=_.find(s,{key:n.key});i.books=i.books||[],i.books.push({item:t.item,match:n,refIndex:t.refIndex,score:t.score})})}),s=_.filter(s,"books"),_.each(s,function(t,n){t.books=_.uniqBy(t.books,"match.value"),t.books=t.books.slice(0,5),t.books.length<2&&(s[n]=null),t.active=!1}),s=_.compact(s),s.length&&(s[0].active=!0),console.log("sections",s),this.autocompleteResults=s,console.log(s)},active_ac_item:function(e){_.each(this.autocompleteResults,function(s){s.active=!1}),e.active=!0},searchAutocompleteResult:function(e){const s=e.match.value;this.$store.commit("prop",{key:"searchQuery",value:s}),this.search()},searchEnterBlur:_.debounce(function(e){this.$refs.searchInput.blur()},100,{leading:!1,trailing:!0}),restoreOptions:function(){updateListRenderingOpts()},focusOnSearch:function(){scroll({top:0}),this.$refs.searchInput.focus()},modifyQuery:function(e){let s=e;return(e.match(/&/i)||e.match(/ and /i)||e.match(/ a /i)||e.match(/ the /i))&&(s=e+"|"+e.replace(/ & /ig," ")+"|"+e.replace(/ and /ig," ")+"|"+e.replace(/ a /ig," ")+"|"+e.replace(/ an /ig," ")+"|"+e.replace(/ the /ig," ")),s},iosAutozoomDisable:function(){if(document.querySelector(".is-ios")){let s=document.querySelector("head").querySelector("meta[name=viewport]");s.content="width=device-width, initial-scale=1.0, user-scalable=0",clearTimeout(this.enableZoomTimer),this.enableZoomTimer=setTimeout(function(){s.content="width=device-width, initial-scale=1.0, user-scalable=1"},700)}}},computed:{aliciaKeys:function(){const e=_.filter(this.$store.state.listRenderingOpts.scope,["active",!0]);return _.map(e,function(s){return{name:s.key,weight:s.weight||0}})},placeholder:function(){const e=function(s){return _.map(s,function(t){return t.name.replace(".name","")}).join(", ")}(this.aliciaKeys);return"Search: "+e}}},Wa={id:"ale-search",ref:"aleSearch"},Ua=["value","placeholder"],Qa={key:1,class:"autocomplete"},Za={class:"header-wrapper"},Ja=g("div",{class:"title"},"Autocomplete: ",-1),Xa=["onClick"],Ya={class:"content"},xa=["onClick"];function el(e,s,t,n,i,r){const l=zt,c=Ft,y=$a,v=ba,d=At;return p(),m("div",null,[x(l),e.$route.meta.subPage?(p(),Re(c,{key:0,aboveSearch:!0})):S("",!0),g("div",{id:"ale-search-wrap",ref:"searchWrap",class:L({"search-fixed":e.fixedSearch,"highlight-search":e.highlightSearch})},[ke(g("div",{id:"search-dropdown-overlay",onMousedown:s[0]||(s[0]=h=>e.readyToCloseOpts=!0),onTouchstart:s[1]||(s[1]=h=>e.readyToCloseOpts=!0),onTouchmove:s[2]||(s[2]=(...h)=>r.dontCloseOpts&&r.dontCloseOpts(...h)),onClick:s[3]||(s[3]=(...h)=>r.closeOpts&&r.closeOpts(...h))},null,544),[[Dt,e.listName]]),g("div",Wa,[g("div",{class:"search-wrapper",onClick:s[7]||(s[7]=h=>e.$refs.searchInput.focus())},[g("input",{type:"search",ref:"searchInput",value:e.$store.state.searchQuery,onInput:s[4]||(s[4]=(...h)=>r.search&&r.search(...h)),onKeyup:s[5]||(s[5]=Qe((...h)=>r.searchEnterBlur&&r.searchEnterBlur(...h),["enter"])),placeholder:r.placeholder,onFocus:s[6]||(s[6]=h=>e.listName=!1)},null,40,Ua)]),x(y,{"list-name":e.listName,"onUpdate:listName":s[8]||(s[8]=h=>e.listName=h)},null,8,["list-name"]),e.listName?(p(),Re(v,{key:0,"list-name":e.listName,"onUpdate:listName":s[9]||(s[9]=h=>e.listName=h)},null,8,["list-name"])):S("",!0)],512),e.$route.meta.gallery&&e.$store.state.windowWidth>=450?(p(),Re(d,{key:0})):S("",!0)],2),e.useAutocomplete&&e.autocompleteResults&&e.autocompleteResults.length?(p(),m("div",Qa,[g("div",Za,[Ja,(p(!0),m(ee,null,ae(e.autocompleteResults,h=>(p(),m("div",{class:L(["header",{active:h.active}]),key:h.key+"-header",onClick:B=>r.active_ac_item(h)},[g("div",null,j(h.name),1)],10,Xa))),128))]),e.item.active?(p(!0),m(ee,{key:0},ae(e.autocompleteResults,h=>(p(),m("div",{class:"content-wrapper",key:h.key},[g("div",Ya,[(p(!0),m(ee,null,ae(h.books,B=>(p(),m("div",{onClick:T=>r.searchAutocompleteResult(B)},[g("span",null,j(B.match.value),1)],8,xa))),256))])]))),128)):S("",!0)])):S("",!0)])}var rl=Ne(Ha,[["render",el]]);export{ua as _,rl as a};
